<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Oodfay</title>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:sans-serif;background:#ede4ff;color:#2c174e;text-align:center;padding:1rem;margin:0;}
    h1{color:#a97ef9;}
    #puzzle-wrapper{width:min(800px,100%);margin:0 auto;padding:8px;}
    #wordsearch{
      --cols:15; --gap:2px;
      display:grid; grid-template-columns:repeat(var(--cols),1fr); gap:var(--gap);
      width:100%; margin:1rem auto 1.5rem; user-select:none;
    }
    .cell{
      aspect-ratio:1/1; width:100%; height:auto; border:1px solid #ccc; background:#f7f4ff;
      text-transform:uppercase; font-weight:bold; font-size:clamp(12px,2.7vw,16px);
      display:flex; align-items:center; justify-content:center; cursor:pointer;
    }
    .cell.selected{background:#a97ef9;color:#fff;}
    .cell.found{background:#78aaff;color:#fff;}

    .word-bank{
      display:flex; flex-wrap:wrap; justify-content:center; gap:.5rem;
      width:min(700px,100%); margin:0 auto 1.5rem;
    }
    .word{padding:.4rem .9rem;background:#f7f4ff;border-radius:1rem;border:1px solid #ccc;cursor:pointer;font-size:.95rem;white-space:nowrap;}
    .word.found{background:#a97ef9;color:#fff;text-decoration:line-through;}

    .controls{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;}
    button{background:#cc66dd;color:#fff;padding:.6rem 1.4rem;border:none;border-radius:.7rem;font-size:1rem;cursor:pointer;}

    /* Print */
    @page{ size: letter portrait; margin:0; }
    @media print{
      .controls{display:none!important;}
      body{background:#fff!important;color:#000!important;margin:0;padding:0;}
      #puzzle-wrapper{transform:scale(0.75);transform-origin:top center;margin:0;width:100%;}
      #wordsearch{grid-template-columns:repeat(15,2rem);gap:2px;}
      .cell{aspect-ratio:auto;width:2rem;height:2rem;font-size:1rem;background:#fff!important;color:#000!important;border:1px solid #000!important;}
      .word,.word.found{background:#fff!important;color:#000!important;text-decoration:none!important;}
    }
  </style>
</head>
<body>
  <div id="puzzle-wrapper">
    <h1>Oodfay</h1>
    <div id="wordsearch"></div>
    <div class="word-bank" id="wordlist"></div>
    <div class="controls">
      <button onclick="window.print()">Print</button>
      <button onclick="window.location.href='games.html'">Return to Games</button>
    </div>
  </div>

  <script>
    const words=['IZZAPAY','ACOTAY','EGGWAY','ARROTCAY','ALADSAY','OCOLATECHAY','EATMAY','ILKMAY','ANDYCAY','ODASAY','OCCOLIBRAY','AKECAY','OOKIECAY','EESECHAY'];
    const gridSize=15;
    const grid=Array.from({length:gridSize},()=>Array(gridSize).fill(''));
    const directions=[[0,1],[1,0],[1,1],[-1,1],[0,-1],[-1,0],[-1,-1],[1,-1]];
    const placedWords=[];
    function canPlace(word,row,col,dir){
      const[dx,dy]=dir;
      for(let i=0;i<word.length;i++){
        let x=row+i*dx, y=col+i*dy;
        if(x<0||x>=gridSize||y<0||y>=gridSize) return false;
        if(grid[x][y] && grid[x][y]!==word[i]) return false;
      } return true;
    }
    function placeWord(word){
      for(let t=0;t<1000;t++){
        let dir=directions[Math.floor(Math.random()*directions.length)];
        let row=Math.floor(Math.random()*gridSize);
        let col=Math.floor(Math.random()*gridSize);
        if(canPlace(word,row,col,dir)){
          let pos=[];
          for(let i=0;i<word.length;i++){
            let x=row+i*dir[0], y=col+i*dir[1];
            grid[x][y]=word[i]; pos.push(`${x}-${y}`);
          }
          placedWords.push({word,positions:pos}); return;
        }
      }
    }
    words.forEach(placeWord);
    for(let r=0;r<gridSize;r++){ for(let c=0;c<gridSize;c++){ if(!grid[r][c]) grid[r][c]=String.fromCharCode(65+Math.random()*26|0); } }

    const searchEl=document.getElementById('wordsearch');
    const wordListEl=document.getElementById('wordlist');
    const cells={}; const selected=[];
    for(let r=0;r<gridSize;r++){
      for(let c=0;c<gridSize;c++){
        const cell=document.createElement('div');
        cell.className='cell'; cell.textContent=grid[r][c]; cell.dataset.pos=`${r}-${c}`;
        searchEl.appendChild(cell); cells[cell.dataset.pos]=cell;
        cell.addEventListener('click',()=>{
          cell.classList.toggle('selected');
          if(cell.classList.contains('selected')) selected.push(cell);
          else selected.splice(selected.indexOf(cell),1);
          checkSelection();
        });
      }
    }
    words.forEach(word=>{
      const span=document.createElement('span');
      span.className='word'; span.textContent=word; span.dataset.word=word;
      wordListEl.appendChild(span);
      span.addEventListener('click',()=>{
        const entry=placedWords.find(w=>w.word===word);
        const isFound=span.classList.toggle('found');
        entry?.positions.forEach(p=>cells[p].classList.toggle('found',isFound));
      });
    });
    function checkSelection(){
      const s=selected.map(c=>c.textContent).join('');
      const rev=s.split('').reverse().join('');
      const match=words.find(w=>w===s||w===rev);
      if(match){
        const entry=placedWords.find(w=>w.word===match);
        entry?.positions.forEach(p=>{ cells[p].classList.remove('selected'); cells[p].classList.add('found'); });
        document.querySelector(`.word[data-word="${match}"]`)?.classList.add('found');
        selected.length=0;
      }
    }
  </script>
</body>
</html>
